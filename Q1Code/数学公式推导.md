# 烟幕干扰弹遮蔽分析数学公式推导

## 1. 基本物理模型

### 1.1 坐标系定义
- 采用三维直角坐标系 $(x, y, z)$
- $z$ 轴正方向向上，表示高度
- 原点设在地面假目标位置

### 1.2 基本参数定义

| 符号 | 含义 | 单位 |
|------|------|------|
| $g$ | 重力加速度 | $m/s^2$ |
| $v_m$ | 导弹速度 | $m/s$ |
| $v_u$ | 无人机速度 | $m/s$ |
| $v_s$ | 烟幕下沉速度 | $m/s$ |
| $R$ | 烟幕有效半径 | $m$ |
| $T$ | 烟幕持续时间 | $s$ |

## 2. 运动轨迹方程

### 2.1 导弹运动轨迹

导弹 M1 从初始位置 $\vec{P}_{M0} = (x_{M0}, y_{M0}, z_{M0})$ 以恒定速度 $v_m$ 飞向目标：

$$\vec{P}_M(t) = \vec{P}_{M0} + \vec{v}_M \cdot t$$

其中方向向量：
$$\vec{v}_M = v_m \cdot \frac{\vec{P}_{target} - \vec{P}_{M0}}{|\vec{P}_{target} - \vec{P}_{M0}|}$$

展开为分量形式：
$$\begin{cases}
x_M(t) = x_{M0} + v_{Mx} \cdot t \\
y_M(t) = y_{M0} + v_{My} \cdot t \\
z_M(t) = z_{M0} + v_{Mz} \cdot t
\end{cases}$$

### 2.2 无人机运动轨迹

无人机 FY1 在水平面内匀速飞行（$z$ 方向速度为 0）：

$$\vec{P}_{FY1}(t) = \vec{P}_{FY10} + \vec{v}_{FY1} \cdot t$$

其中：
$$\vec{v}_{FY1} = (v_{FY1x}, v_{FY1y}, 0)$$

### 2.3 干扰弹抛物运动

干扰弹在 $t = t_{drop}$ 时刻投放，运动方程为：

$$\vec{P}_{bomb}(t) = \vec{P}_{drop} + \vec{v}_{FY1} \cdot (t - t_{drop}) - \frac{1}{2}g(t - t_{drop})^2 \vec{e}_z$$

其中 $\vec{P}_{drop} = \vec{P}_{FY1}(t_{drop})$ 为投放位置。

### 2.4 烟幕云团运动

烟幕在 $t = t_{burst}$ 时刻起爆，随后垂直下沉：

$$\vec{P}_{cloud}(t) = \vec{P}_{burst} - v_s \cdot (t - t_{burst}) \vec{e}_z, \quad t \geq t_{burst}$$

其中 $\vec{P}_{burst}$ 为起爆位置。

## 3. 遮蔽条件数学化

### 3.1 距离函数

导弹与烟幕中心的距离函数：

$$d(t) = |\vec{P}_M(t) - \vec{P}_{cloud}(t)|$$

### 3.2 遮蔽条件

遮蔽条件为：
$$d(t) \leq R$$

即：
$$|\vec{P}_M(t) - \vec{P}_{cloud}(t)|^2 \leq R^2$$

## 4. 解析解推导

### 4.1 距离平方函数展开

设：
- $\vec{A} = \vec{P}_{M0} - \vec{P}_{cloud0}$
- $\vec{B} = \vec{v}_M - \vec{v}_{cloud}$

其中 $\vec{P}_{cloud0}$ 和 $\vec{v}_{cloud}$ 分别为烟幕的初始位置和速度向量。

则距离平方函数为：
$$d^2(t) = |\vec{A} + \vec{B} \cdot t|^2 = (\vec{A} + \vec{B} \cdot t) \cdot (\vec{A} + \vec{B} \cdot t)$$

展开得：
$$d^2(t) = \vec{A} \cdot \vec{A} + 2(\vec{A} \cdot \vec{B})t + (\vec{B} \cdot \vec{B})t^2$$

### 4.2 二次不等式

遮蔽条件转化为二次不等式：
$$(\vec{B} \cdot \vec{B})t^2 + 2(\vec{A} \cdot \vec{B})t + (\vec{A} \cdot \vec{A}) - R^2 \leq 0$$

设二次方程 $at^2 + bt + c = 0$ 的系数为：
$$\begin{cases}
a = \vec{B} \cdot \vec{B} = |\vec{B}|^2 \\
b = 2(\vec{A} \cdot \vec{B}) \\
c = \vec{A} \cdot \vec{A} - R^2 = |\vec{A}|^2 - R^2
\end{cases}$$

### 4.3 判别式分析

判别式：
$$\Delta = b^2 - 4ac = 4(\vec{A} \cdot \vec{B})^2 - 4|\vec{B}|^2(|\vec{A}|^2 - R^2)$$

**情况分析：**

1. **$\Delta < 0$**: 无实数解，导弹轨迹不与烟幕球体相交
2. **$\Delta = 0$**: 一个实数解，导弹轨迹与烟幕球体相切
3. **$\Delta > 0$**: 两个实数解，导弹轨迹穿越烟幕球体

### 4.4 解的表达式

当 $\Delta \geq 0$ 时，遮蔽时间区间为：
$$t_1 = \frac{-b - \sqrt{\Delta}}{2a}, \quad t_2 = \frac{-b + \sqrt{\Delta}}{2a}$$

即：
$$t_1 = \frac{-2(\vec{A} \cdot \vec{B}) - 2\sqrt{(\vec{A} \cdot \vec{B})^2 - |\vec{B}|^2(|\vec{A}|^2 - R^2)}}{2|\vec{B}|^2}$$

$$t_2 = \frac{-2(\vec{A} \cdot \vec{B}) + 2\sqrt{(\vec{A} \cdot \vec{B})^2 - |\vec{B}|^2(|\vec{A}|^2 - R^2)}}{2|\vec{B}|^2}$$

## 5. 时间窗口匹配

### 5.1 有效时间区间

烟幕有效时间区间：
$$[t_{smoke\_start}, t_{smoke\_end}] = [t_{burst}, t_{burst} + T]$$

导弹在遮蔽半径内的时间区间：
$$[t_{dist\_start}, t_{dist\_end}] = [t_1, t_2]$$

### 5.2 交集计算

有效遮蔽时间区间为两个区间的交集：
$$[t_{shield\_start}, t_{shield\_end}] = [\max(t_1, t_{burst}), \min(t_2, t_{burst} + T)]$$

有效遮蔽时间：
$$T_{shield} = \begin{cases}
t_{shield\_end} - t_{shield\_start}, & \text{if } t_{shield\_end} > t_{shield\_start} \\
0, & \text{otherwise}
\end{cases}$$

## 6. 向量分量展开

### 6.1 具体坐标表示

设导弹初始位置 $\vec{P}_{M0} = (x_{M0}, y_{M0}, z_{M0})$，烟幕初始等效位置 $\vec{P}_{cloud0} = (x_{C0}, y_{C0}, z_{C0})$。

导弹速度向量：
$$\vec{v}_M = (v_{Mx}, v_{My}, v_{Mz})$$

烟幕速度向量：
$$\vec{v}_{cloud} = (0, 0, -v_s)$$

### 6.2 向量运算展开

$$\vec{A} = (x_{M0} - x_{C0}, y_{M0} - y_{C0}, z_{M0} - z_{C0})$$

$$\vec{B} = (v_{Mx}, v_{My}, v_{Mz} + v_s)$$

$$\vec{A} \cdot \vec{B} = (x_{M0} - x_{C0}) \cdot v_{Mx} + (y_{M0} - y_{C0}) \cdot v_{My} + (z_{M0} - z_{C0}) \cdot (v_{Mz} + v_s)$$

$$|\vec{B}|^2 = v_{Mx}^2 + v_{My}^2 + (v_{Mz} + v_s)^2$$

$$|\vec{A}|^2 = (x_{M0} - x_{C0})^2 + (y_{M0} - y_{C0})^2 + (z_{M0} - z_{C0})^2$$

## 7. 参数敏感性分析公式

### 7.1 半径敏感性

遮蔽时间关于半径的偏导数：
$$\frac{\partial T_{shield}}{\partial R} = \frac{\partial}{\partial R}(t_2 - t_1) = \frac{R}{|\vec{B}|^2 \sqrt{\Delta}}$$

### 7.2 速度敏感性

遮蔽时间关于导弹速度的敏感性分析需要考虑速度变化对 $\vec{B}$ 和判别式 $\Delta$ 的影响：

$$\frac{\partial T_{shield}}{\partial v_m} = \frac{\partial t_2}{\partial v_m} - \frac{\partial t_1}{\partial v_m}$$

## 8. 优化目标函数

### 8.1 最大遮蔽时间目标

优化目标：
$$\max_{t_{drop}, t_{burst}, R} T_{shield}(t_{drop}, t_{burst}, R)$$

约束条件：
$$\begin{cases}
t_{drop} > 0 \\
t_{burst} > 0 \\
R > 0 \\
t_{burst} + t_{drop} < t_{missile\_arrival}
\end{cases}$$

### 8.2 拉格朗日优化

构建拉格朗日函数：
$$L = T_{shield} - \sum_i \lambda_i g_i$$

其中 $g_i$ 为约束条件。

## 9. 数值计算验证

### 9.1 误差分析

解析解与数值解的误差：
$$\epsilon = |T_{shield}^{analytical} - T_{shield}^{numerical}|$$

### 9.2 收敛性分析

数值方法的收敛条件：
$$\lim_{h \to 0} \frac{|f(x+h) - f(x)|}{h} = f'(x)$$

其中 $h$ 为时间步长。

## 10. 物理意义解释

### 10.1 几何解释

遮蔽条件的几何意义是导弹轨迹直线与以烟幕中心为球心、半径为 $R$ 的球体的交集。

### 10.2 物理约束

1. **因果性约束**: $t_{burst} > t_{drop}$
2. **重力约束**: 干扰弹轨迹受重力影响
3. **速度约束**: 各物体速度为正值
4. **空间约束**: 所有位置坐标在合理范围内

---

**备注**: 本公式推导基于理想化假设，实际应用中还需考虑空气阻力、风力、大气扰动等因素的影响。
