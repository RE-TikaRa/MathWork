# Q1 烟幕干扰弹系统参数文档

## 系统概述
烟幕干扰弹主要通过化学燃烧或爆炸分散形成烟幕或气溶胶云团，在目标前方特定空域形成遮蔽，干扰敌方导弹的制导系统。

## 场景参数设置

### 基础几何参数
| 参数名称 | 代码变量 | 数值 | 单位 | 说明 |
|---------|---------|------|------|------|
| M1导弹起始位置 | `M1_start` | [20000.0, 0.0, 2000.0] | m | 敌方导弹发射点 |
| 假目标位置 | `FO` | [0.0, 0.0, 0.0] | m | 假目标坐标（原点） |
| 真目标中心 | `RO_center` | [0.0, 200.0, 5.0] | m | 真实保护目标位置 |
| 真目标半径 | `RO_radius` | √74 ≈ 8.6 | m | 球形抽象半径 |
| FY1无人机起始位置 | `FY1_start` | [17800.0, 0.0, 1800.0] | m | 投放平台初始位置 |

### 运动参数
| 参数名称 | 代码变量 | 数值 | 单位 | 说明 |
|---------|---------|------|------|------|
| M1导弹速度 | `v_missile` | 300.0 | m/s | 导弹巡航速度 |
| FY1飞行速度 | `fy_speed` | 120.0 | m/s | 无人机飞行速度 |
| 重力加速度 | `g` | 9.8 | m/s² | 标准重力加速度 |
| 烟团下沉速度 | `smoke_v_down` | 3.0 | m/s | 烟团重力下沉速度 |

### 时间节点参数
| 参数名称 | 代码变量 | 数值 | 单位 | 说明 |
|---------|---------|------|------|------|
| 投放时间 | `t_drop` | 1.5 | s | FY1投放干扰弹时间 |
| 起爆时间 | `t_det` | 5.1 | s | 干扰弹起爆时间 |
| 烟团持续时间 | `smoke_duration` | 20.0 | s | 烟团有效持续时间 |
| 仿真总时间 | `total_time` | 66.67 | s | 总仿真时长 |
| 时间步长 | `dt` | 0.01 | s | 数值积分步长 |

### 几何计算参数
| 参数名称 | 代码变量 | 数值 | 单位 | 说明 |
|---------|---------|------|------|------|
| 烟团半径 | `R_smoke` | 10.0 | m | 烟团球形半径 |
| 切锥半角 | `alpha` | arcsin(R/d) | rad | 视线切锥半角 |
| 切锥顶角 | `apex_angle` | 2×alpha | rad | 切锥顶角 |
| 切面高度 | `h_max` | d×cos(alpha) | m | 切锥高度 |
| 切面半径 | `rim_radius` | R | m | 切面圆半径 |

## 代码中的关键函数

### 核心计算函数
- `get_M1_position(t)`: 计算M1导弹在时间t的位置
- `_smoke_center(t)`: 计算烟团中心在时间t的位置
- `is_fully_occluded(t)`: 判断时间t是否完全遮蔽
- `analyze_projection_area()`: 分析视线投影区域变化
- `analyze_full_occlusion()`: 分析完全遮蔽时间段

### 可视化函数
- `_draw_scene(ax, t)`: 绘制3D场景
- `_shade_occlusion(ax, ts, flags)`: 绘制遮蔽时间段阴影
- `_compose_info_text(t)`: 生成参数信息面板文本
- `_build_layout()`: 构建界面布局

## 物理模型说明

### 导弹运动模型
M1导弹采用匀速直线运动模型：
```
位置(t) = M1_start + (FO - M1_start) / ||FO - M1_start|| × v_missile × t
```

### FY1无人机运动模型
FY1无人机朝向假目标FO直线飞行：
```
方向向量 = (FO - FY1_start) / ||FO - FY1_start||
位置(t) = FY1_start + 方向向量 × fy_speed × t
```

### 干扰弹抛物运动模型
投放后的干扰弹遵循抛物运动：
```
位置(t) = 投放位置 + 初速度×(t-t_drop) + 0.5×重力×(t-t_drop)²
```

### 烟团运动模型
起爆后烟团以固定速度下沉：
```
位置(t) = 起爆位置 + [0, 0, -smoke_v_down×(t-t_det)]
```

### 遮蔽判定模型
基于几何光学原理的切锥遮蔽判定：
1. 计算M1到RO的视线方向
2. 构建以RO为底面的切锥
3. 判断烟团是否完全遮挡切锥

## 输出结果说明

### 关键指标
- **有效遮蔽时长**: 烟团完全遮蔽M1视线的总时间
- **遮蔽开始时间**: 首次完全遮蔽的时刻
- **遮蔽结束时间**: 最后完全遮蔽的时刻
- **最小视线距离**: M1到RO的最近距离

### 实时显示参数
- 当前时间和遮蔽状态
- M1到RO的距离
- 视线切锥的几何参数（半角、顶角等）
- FY1和烟团的当前位置

## 技术实现细节

### 数值精度控制
- 使用NumPy float64精度进行计算
- 时间步长0.01s保证计算精度
- 几何判定使用1e-9容差避免数值误差

### 性能优化策略
- 预计算遮蔽状态数组，避免重复计算
- 3D渲染优化网格密度
- 图例去重机制防止重复显示

### 交互功能
- 实时播放控制（播放/暂停/重置）
- 时间滑块精确定位
- 倍速播放调节
- 3D视角交互式调整
